---
title: "Warm-up mini-Report: Mosquito Blood Hosts in \n Salt Lake City, Utah"
author: "John Wood"
date: "`r Sys.Date()`"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# ABSTRACT
The West Nile Virus (WNV) is a dangerous disease prevalent globally. The design of this study aimed to discover which organisms are the largest reservoirs of West Nile Virus in the Salt Lake City area. After extracting collected mosquito blood, and sequencing its DNA, several host species were identified and counted. The counts of each species were tested against presence or absence of WNV and WNV positivity. The results indicated a positive correlation between house finch blood meal count and WNV positivity. A very low p-value indicated that the correlation was highly statistically significant. This suggests that house finches act as a large reservoir in the spread of West Nile Virus in the Salt Lake City area.

# BACKGROUND
West Nile Virus has plagued the globe for decades. Although disease control efforts have mitigated its spread, the virus is still present and deadly. In the United States, West Nile Virus (WNV) causes over 1,300 severe illnesses affecting the central nervous system and even causes over 130 deaths annually (CDC, 2025). The primary method of transmission is via mosquitoes, causing WNV cases to peak during the mosquito season.

Mosquitoes rely on host blood meals for their life cycle, causing the host's DNA to be found in the mosquito's blood. Because the virus is transmitted by mosquitoes, analyzing mosquito blood offers great insights into how the virus spreads.

Polymerase Chain Reaction (PCR) is a reliable method which utilizes Taq polymerase to amplify DNA segments for further analysis. Abundant DNA can then be sequenced and matched to an online data bank (BLAST) to identify which organism the sequence belongs to.

Previous literature suggests that in North America, common birds including the Blue Jay, House Finch, and American Crow are competent reservoirs for the West Nile Virus (Komar, 2003). *Figure 1* highlights the days viremia is detectable in some common birds. House finches stand out as a fantastic candidate of study due to their long viremia and abundance in the Salt Lake City area.


## *Figure 1* - Viremia Duration in North American Birds

```{r viremia, include=TRUE, eval=TRUE, warning=FALSE, fig.align='left', fig.width=4.75, fig.height=7}
# Manually transcribe duration (mean, lo, hi) from the last table column
duration <- data.frame(
  Bird = c("Canada Goose","Mallard", 
           "American Kestrel","Northern Bobwhite",
           "Japanese Quail","Ring-necked Pheasant",
           "American Coot","Killdeer",
           "Ring-billed Gull","Mourning Dove",
           "Rock Dove","Monk Parakeet",
           "Budgerigar","Great Horned Owl",
           "Northern Flicker","Blue Jay",
           "Black-billed Magpie","American Crow",
           "Fish Crow","American Robin",
           "European Starling","Red-winged Blackbird",
           "Common Grackle","House Finch","House Sparrow"),
  mean = c(4.0,4.0,4.5,4.0,1.3,3.7,4.0,4.5,5.5,3.7,3.2,2.7,1.7,6.0,4.0,
           4.0,5.0,3.8,5.0,4.5,3.2,3.0,3.3,6.0,4.5),
  lo   = c(3,4,4,3,0,3,4,4,4,3,3,1,0,6,3,
           3,5,3,4,4,3,3,3,5,2),
  hi   = c(5,4,5,5,4,4,4,5,7,4,4,4,4,6,5,
           5,5,5,7,5,4,3,4,7,6)
)

# Choose some colors
cols <- c(rainbow(30)[c(10:29,1:5)])  # rainbow colors

# horizontal barplot
par(mar=c(5,12,2,2))  # wider left margin for names
bp <- barplot(duration$mean, horiz=TRUE, names.arg=duration$Bird,
              las=1, col=cols, xlab="Days of detectable viremia", xlim=c(0,7))

# add error bars
arrows(duration$lo, bp, duration$hi, bp,
       angle=90, code=3, length=0.05, col="black", xpd=TRUE)
```

# STUDY QUESTION and HYPOTHESIS

## Questions  
Which species act as large reservoirs of West Nile Virus in the Salt Lake City area? Which species require further investigation to mitigate the spread of West Nile Virus?

## Hypothesis 
House finches are the largest reservoir of West Nile Virus. House finches are responsible for a large portion of the spread of West Nile Virus in the Salt Lake City area.
  
## Prediction
Areas with higher blood meal counts of house finches will have more positive test results for West Nile Virus.

# METHODS
## Data Collection
Mosquitoes were collected by gravid and CO~2~ traps in various urban, suburban, and rural locations surrounding Salt Lake City.

The collected mosquitoes were crushed in small vials. The mosquito blood was then subjected to Polymerase Chain Reaction (PCR) and electronic sequencing to identify specific DNA sequences. The identified sequences were then compared with the BLAST online database to determine organism matches. The matched organisms revealed which hosts the mosquitoes had fed on for a blood meal.

Geographical locations were identified as either WNV-positive or WNV-negative. Organismal blood meal count and positivity of West Nile Virus were then compared.

## *Figure 2* - Blood Meal Count in WNV-negative and WNV-positive Locations Barplot

Host blood meal counts were aggregated and organized by species. To visualize the data, mosquito blood meal counts from each host species were compiled in two barplots: one showing sites with no WNV-positive pools and the other showing sites with one or more WNV-positive pools. 

```{r first-analysis, warning=FALSE}
## import counts_matrix: data.frame with column 'loc_positives' (0/1) and host columns 'host_*'
counts_matrix <- read.csv("./bloodmeal_plusWNV_for_BIOL3070.csv")

## 1) Identify host columns
host_cols <- grep("^host_", names(counts_matrix), value = TRUE)

if (length(host_cols) == 0) {
  stop("No columns matching '^host_' were found in counts_matrix.")
}

## 2) Ensure loc_positives is present and has both levels 0 and 1 where possible
counts_matrix$loc_positives <- factor(counts_matrix$loc_positives, levels = c(0, 1))

## 3) Aggregate host counts by loc_positives
agg <- stats::aggregate(
  counts_matrix[, host_cols, drop = FALSE],
  by = list(loc_positives = counts_matrix$loc_positives),
  FUN = function(x) sum(as.numeric(x), na.rm = TRUE)
)

## make sure both rows exist; if one is missing, add a zero row
need_levels <- setdiff(levels(counts_matrix$loc_positives), as.character(agg$loc_positives))
if (length(need_levels)) {
  zero_row <- as.list(rep(0, length(host_cols)))
  names(zero_row) <- host_cols
  for (lv in need_levels) {
    agg <- rbind(agg, c(lv, zero_row))
  }
  ## restore proper type
  agg$loc_positives <- factor(agg$loc_positives, levels = c("0","1"))
  ## coerce numeric host cols (they may have become character after rbind)
  for (hc in host_cols) agg[[hc]] <- as.numeric(agg[[hc]])
  agg <- agg[order(agg$loc_positives), , drop = FALSE]
}

## 4) Decide species order (overall abundance, descending)
overall <- colSums(agg[, host_cols, drop = FALSE], na.rm = TRUE)
host_order <- names(sort(overall, decreasing = TRUE))
species_labels <- rev(sub("^host_", "", host_order))  # nicer labels

## 5) Build count vectors for each panel in the SAME order
counts0 <- rev(as.numeric(agg[agg$loc_positives == 0, host_order, drop = TRUE]))
counts1 <- rev(as.numeric(agg[agg$loc_positives == 1, host_order, drop = TRUE]))

## 6) Colors: reuse your existing 'cols' if it exists and is long enough; otherwise generate
if (exists("cols") && length(cols) >= length(host_order)) {
  species_colors <- setNames(cols[seq_along(host_order)], species_labels)
} else {
  species_colors <- setNames(rainbow(length(host_order) + 10)[seq_along(host_order)], species_labels)
}

## 7) Shared x-limit for comparability
xmax <- max(c(counts0, counts1), na.rm = TRUE)
xmax <- if (is.finite(xmax)) xmax else 1
xlim_use <- c(0, xmax * 1.08)

## 8) Plot: two horizontal barplots with identical order and colors
op <- par(mfrow = c(1, 2),
          mar = c(4, 12, 3, 2),  # big left margin for species names
          xaxs = "i")           # a bit tighter axis padding

## Panel A: No WNV detected (loc_positives = 0)
barplot(height = counts0,
        names.arg = species_labels, 
        cex.names = .5,
        cex.axis = .5,
        col = rev(unname(species_colors[species_labels])),
        horiz = TRUE,
        las = 1,
        xlab = "Bloodmeal counts",
        main = "Locations WNV (-)",
        xlim = xlim_use)

## Panel B: WNV detected (loc_positives = 1)
barplot(height = counts1,
        names.arg = species_labels, 
        cex.names = .5,
        cex.axis = .5,
        col = rev(unname(species_colors[species_labels])),
        horiz = TRUE,
        las = 1,
        xlab = "Bloodmeal counts",
        main = "Locations WNV (+)",
        xlim = xlim_use)

par(op)

## Keep the colors mapping for reuse elsewhere
host_species_colors <- species_colors
```
## *Figure 3* - House Finch Blood Meal Count vs. WNV-Positive Pools & WNV Positvity Rate Generalized Linear Model

Two generalized linear models were performed to statistically evaluate the relationship seen in the barplots. The first tested the correlation between house finch blood meal count and whether not a pool had at least one positive WNV result. The second tested the relationship between house finch blood meal count and the amount of positive tests in a location to further solidify any correlation.

```{r}
# second-analysis-or-plot, glm with house finch alone against binary +/_
glm1 <- glm(loc_positives ~ host_House_finch,
            data = counts_matrix,
            family = binomial)
summary(glm1)

#glm with house-finch alone against positivity rate
glm2 <- glm(loc_rate ~ host_House_finch,
            data = counts_matrix)
summary(glm2)
```

# DISCUSSION
## Barplot (*Figure 2*) Analysis
As seen visually, areas where mosquitoes had a larger count of blood meals from house finches also detected at least one positive result for West Nile Virus. Other species fluctuated in abundance between the WNV-negative and WNV-positive pools, and did not appear to have any clear correlation with the presence or absence of the virus. The relative prevalence of the house finch blood meal counts in WNV-positive areas compared to WNV-negative areas suggests that the bird is a large reservoir of the virus, playing a key role in its spread. This is likely due to the house finch's relatively long viremia duration (see *Figure 1*) and high abundance in the Salt Lake City area.

## Generalized Linear Model (*Figure 3*) Analysis
The first statistical test aimed to understand whether or not a higher house finch blood meal count predicted a site to have at least one WNV-positive pool. The estimated slope of correlation was 0.3468, indicating a positive correlation. The p-value was 0.0287, indicating that the correlation is statistically significant.

The second tested analyzed whether or not a higher house finch blood meal count predicted more positivity (positive result counts) in a site. The estimated slope of correlation was 0.0275, indicating another positive correlation. The p-value was 4.54e-5, indicating the correlation is very statistically significant.

Both tests lead to the same inference: the visual results present in the barplots are statistically sound. It can be confidently reasoned that areas which include a higher number of house finch blood meals (suggesting a higher population of house finches) predict more positive results for West Nile Virus. Thus, in the Salt Lake area, house finches make up a large proportion of the WNV reservoir.

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

While well-designed, the study may have missed necessary blood meal pools because only two types of mosquito traps were used (gravid and CO~2~). Additionally, the collection period was only performed at one time of year, and did not capture mosquito pools throughout the peak of WNV season. Other collection strategies could be used in the future to ensure an accurate representation of the mosquito population is obtained. It is possible other organisms play a key role in WNV's pathology.

Knowing that house finches are largely responsible for the spread of West Nile Virus, several future actions could be taken. Future studies and protocols focused on the house finch could greatly reduce WNV in the Salt Lake City area. For example, a study could track house finches to understand their movement patterns throughout the area. Disease control centers could then focus their efforts (ex. mosquito spraying and animal vaccination) in areas with large house finch populations.

# CONCLUSION
The hypothesis in question predicted that house finches are the largest reservoir of West Nile Virus in the Salt Lake City area. Barplot and generalized linear model analyses provided strong statistical evidence that areas with higher blood meal counts from house finches predict more West Nile Virus positivity. Thus, the hypothesis is supported by statistically reliable data. Future study of house finches may reveal methods to mitigate the spread of West Nile Virus.

# REFERENCES     
1. Brandler S, Tangy F. Vaccines in development against West Nile virus. Viruses. 2013 Sep 30;5(10):2384-409. doi: 10.3390/v5102384. PMID: 24084235; PMCID: PMC3814594.

2. Centers for Disease Control and Prevention. (n.d.). About West Nile. Centers for Disease Control and Prevention. https://www.cdc.gov/west-nile-virus/about/index.html

3. ChatGPT. OpenAI, version Jan 2025. Used as a reference for functions such as plot() and to correct syntax errors. Accessed `r Sys.Date()`.

4. Komar N, Langevin S, Hinten S, Nemeth N, Edwards E, Hettler D, Davis B, Bowen R, Bunning M. Experimental infection of North American birds with the New York 1999 strain of West Nile virus. Emerg Infect Dis. 2003 Mar;9(3):311-22. https://doi.org/10.3201/eid0903.020628